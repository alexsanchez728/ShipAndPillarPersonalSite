<!DOCTYPE html>
<html lang="en">

<head>
  <title>three.js webgl - geometry - shapes</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <style>
    body {
      font-family: Monospace;
      background-color: #4C8BA8;
      margin: 0px;
      overflow: hidden;
    }
  </style>
</head>

<body>

  <script type="text/javascript" src="./lib/three.min.js"></script>
  <script type="text/javascript" src="./javascripts/main.js"></script>

  <script>

    var container;

    var camera, scene, renderer;

    var ship;

    var group, guide;

    var targetRotation = 0;
    var targetRotationOnMouseDown = 0;

    var mouseX = 0;
    var mouseXOnMouseDown = 0;

    var windowHalfX = window.innerWidth / 2;

    var SEPARATION = 60;
    var AMOUNTX = 50;
    var AMOUNTY = 50;
    var particle;

    init();
    animate();

    function init() {

      container = document.createElement('div');
      document.body.appendChild(container);

      var aboutButton = document.createElement('button');
      aboutButton.style.position = 'absolute';
      aboutButton.style.top = '8.5%';
      aboutButton.style.left = '47.5%';
      aboutButton.style.backgroundColor = 'Transparent';
      aboutButton.style.border = 'none';
      aboutButton.style.cursor = 'pointer';
      aboutButton.style.width = 'fit-content';
      aboutButton.style.padding = '1.5%';
      aboutButton.style.textAlign = 'center';
      aboutButton.innerHTML = 'About';
      container.appendChild(aboutButton);

      var contactButton = document.createElement('button');
      contactButton.style.position = 'absolute';
      contactButton.style.top = '48.5%';
      contactButton.style.left = '8.5%';
      contactButton.style.backgroundColor = 'Transparent';
      contactButton.style.border = 'none';
      contactButton.style.cursor = 'pointer';
      contactButton.style.width = 'fit-content';
      contactButton.style.padding = '1.5%';
      contactButton.style.textAlign = 'center';
      contactButton.innerHTML = 'Contact';
      container.appendChild(contactButton);

      var portfolioButton = document.createElement('button');
      portfolioButton.style.position = 'absolute';
      portfolioButton.style.top = '48.5%';
      portfolioButton.style.right = '8.5%';
      portfolioButton.style.backgroundColor = 'Transparent';
      portfolioButton.style.border = 'none';
      portfolioButton.style.cursor = 'pointer';
      portfolioButton.style.padding = '1.5%';
      portfolioButton.style.width = 'fit-content';
      portfolioButton.style.textAlign = 'center';
      portfolioButton.innerHTML = 'Portfolio';
      container.appendChild(portfolioButton);

      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x4C8BA8);
      scene.fog = new THREE.FogExp2(0xB3937D, 0.0018);


      camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1200);
      camera.position.set(0, 150, 500);
      camera.lookAt(scene.position);

      scene.add(camera);

      var light = new THREE.PointLight(0xffffff, 0.8);
      camera.add(light);

      group = new THREE.Group();
      group.position.y = -300;
      scene.add(group);

      guide = new THREE.Group();
      scene.add(guide);

      var material = new THREE.LineBasicMaterial({
        color: 0x0000ff
      });

      // FLOOR OF PARTICLES
      var material = new THREE.SpriteMaterial();
      for (var ix = 0; ix < AMOUNTX; ix++) {
        for (var iy = 0; iy < AMOUNTY; iy++) {
          particle = new THREE.Sprite(material);
          particle.scale.y = 7;
          particle.position.x = ix * SEPARATION - ((AMOUNTX * SEPARATION) / 2);
          particle.position.z = iy * SEPARATION - ((AMOUNTY * SEPARATION) / 2);
          group.add(particle);
        }
      }


      // TEXT LAYER
      // var loader = new THREE.FontLoader();
      // loader.load('../lib/open_sans_light_regular.json', function (font) {
      //   var xMid, text;
      //   var textShape = new THREE.BufferGeometry();
      //   var color = 0x006699;
      //   var matDark = new THREE.LineBasicMaterial({
      //     color: color,
      //     side: THREE.DoubleSide
      //   });
      //   var matLite = new THREE.MeshBasicMaterial({
      //     color: color,
      //     transparent: true,
      //     opacity: 0.4,
      //     side: THREE.DoubleSide
      //   });
      //   var message = "Alex Sanchez";
      //   var shapes = font.generateShapes(message, 80, 2);
      //   var geometry = new THREE.ShapeGeometry(shapes);
      //   geometry.computeBoundingBox();
      //   xMid = - 0.5 * (geometry.boundingBox.max.x - geometry.boundingBox.min.x);
      //   geometry.translate(xMid, 0, 0);
      //   // make shape ( N.B. edge view not visible )
      //   textShape.fromGeometry(geometry);
      //   text = new THREE.Mesh(textShape, matLite);
      //   text.position.z = - 150;
      //   scene.add(text);
      // });
      // END TEXT LAYER


      // ISLAND LAYER
      var geometry = new THREE.BoxGeometry(90, 550, 90);
      var material = new THREE.MeshBasicMaterial({ color: 0xCF6A48 });
      var cube = new THREE.Mesh(geometry, material);
      group.add(cube);
      // END ISLAND LAYER

      var geometry = new THREE.BoxGeometry(20, 10, 10);
      var material = new THREE.MeshBasicMaterial({ color: 0x4D63DB});
      ship = new THREE.Mesh(geometry, material);
      ship.position.set(100, 0, 100);
      guide.add(ship);





      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);
      container.appendChild(renderer.domElement);


      document.addEventListener('mousedown', onDocumentMouseDown, false);
      document.addEventListener('touchstart', onDocumentTouchStart, false);
      document.addEventListener('touchmove', onDocumentTouchMove, false);

      window.addEventListener('resize', onWindowResize, false);

    }
      // EVENT LISTENERS

    function onWindowResize() {

      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();

      renderer.setSize(window.innerWidth, window.innerHeight);

    }

    function onDocumentMouseDown(event) {

      event.preventDefault();

      document.addEventListener('mousemove', onDocumentMouseMove, false);
      document.addEventListener('mouseup', onDocumentMouseUp, false);
      document.addEventListener('mouseout', onDocumentMouseOut, false);

      mouseXOnMouseDown = event.clientX - windowHalfX;
      targetRotationOnMouseDown = targetRotation;

    }

    function onDocumentMouseMove(event) {

      mouseX = event.clientX - windowHalfX;

      targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.02;

    }

    function onDocumentMouseUp(event) {

      document.removeEventListener('mousemove', onDocumentMouseMove, false);
      document.removeEventListener('mouseup', onDocumentMouseUp, false);
      document.removeEventListener('mouseout', onDocumentMouseOut, false);

    }

    function onDocumentMouseOut(event) {

      document.removeEventListener('mousemove', onDocumentMouseMove, false);
      document.removeEventListener('mouseup', onDocumentMouseUp, false);
      document.removeEventListener('mouseout', onDocumentMouseOut, false);

    }

    function onDocumentTouchStart(event) {

      if (event.touches.length == 1) {

        event.preventDefault();

        mouseXOnMouseDown = event.touches[0].pageX - windowHalfX;
        targetRotationOnMouseDown = targetRotation;

      }

    }

    function onDocumentTouchMove(event) {

      if (event.touches.length == 1) {

        event.preventDefault();

        mouseX = event.touches[0].pageX - windowHalfX;
        targetRotation = targetRotationOnMouseDown + (mouseX - mouseXOnMouseDown) * 0.05;

      }

    }

    function rotateCamera() {

      var rotSpeed = 0.0012;
      var x = camera.position.x,
          z = camera.position.z;
        

      camera.position.x = x * Math.cos(rotSpeed) + z * Math.sin(rotSpeed);
      camera.position.z = z * Math.cos(rotSpeed) - x * Math.sin(rotSpeed);

      camera.lookAt(scene.position);

      camera.updateMatrixWorld();
    }

    function rotateGuide() {

      var orbitSpeed = 0.01;
      var x = ship.position.x,
          z = ship.position.z;
          
      ship.position.x = x * Math.cos(orbitSpeed) + z * Math.sin(orbitSpeed);
      ship.position.z = z * Math.cos(orbitSpeed) - x * Math.sin(orbitSpeed);
      ship.lookAt(scene.position);
    }



    // ACTIVATION
    function animate() {

      requestAnimationFrame(animate);
      render();

    }

    function render() {

      rotateCamera();
      rotateGuide();
      group.rotation.y += (targetRotation - group.rotation.y) * 0.05;
      guide.rotation.y += (targetRotation - group.rotation.y) * 0.05;
      renderer.render(scene, camera);

    }

  </script>

</body>

</html>